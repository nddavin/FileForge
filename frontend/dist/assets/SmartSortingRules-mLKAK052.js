import{r as i,j as e}from"./radix-vendor-DXnqCESz.js";import{p as h,a as m,B as c,C as x,b as k,c as F,d as A,e as p,L as o,I as j,S as f,f as g,g as N,h as _,i as n,u as l}from"./index-DHeBa6N9.js";import{P as E,c as T}from"./icons-vendor-4PzZcNxV.js";import"./react-vendor-BS3SOam5.js";import"./utils-vendor-CbK4XRml.js";import"./date-vendor-Cb250gQT.js";function I(){const[v,C]=i.useState([]),[S,w]=i.useState(!0),[y,d]=i.useState(!1),[a,r]=i.useState({name:"",condition_type:"speaker",condition_value:"",action_type:"add_metadata",action_value:""});i.useEffect(()=>{u()},[]);const u=async()=>{try{const s=await fetch(`https://${h}.supabase.co/functions/v1/make-server-24311ee2/rules`,{headers:{Authorization:`Bearer ${m}`}});if(s.ok){const t=await s.json();C(t)}}catch(s){console.error("Error fetching rules:",s)}finally{w(!1)}},b=async s=>{s.preventDefault();try{(await fetch(`https://${h}.supabase.co/functions/v1/make-server-24311ee2/rules`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${m}`},body:JSON.stringify(a)})).ok?(l.success("Rule created successfully"),r({name:"",condition_type:"speaker",condition_value:"",action_type:"add_metadata",action_value:""}),d(!1),await u()):l.error("Failed to create rule")}catch(t){console.error("Error creating rule:",t),l.error("Failed to create rule")}},R=async s=>{if(confirm("Are you sure you want to delete this rule?"))try{(await fetch(`https://${h}.supabase.co/functions/v1/make-server-24311ee2/rules/${s}`,{method:"DELETE",headers:{Authorization:`Bearer ${m}`}})).ok?(l.success("Rule deleted successfully"),await u()):l.error("Failed to delete rule")}catch(t){console.error("Error deleting rule:",t),l.error("Failed to delete rule")}};return S?e.jsx("div",{className:"p-4",children:"Loading rules..."}):e.jsxs("div",{className:"p-4 space-y-4",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("h2",{className:"text-2xl font-bold",children:"Smart Sorting Rules"}),e.jsxs(c,{onClick:()=>d(!y),children:[e.jsx(E,{className:"w-4 h-4 mr-2"}),"Add Rule"]})]}),y&&e.jsxs(x,{children:[e.jsxs(k,{children:[e.jsx(F,{children:"Create New Rule"}),e.jsx(A,{children:"Automatically organize files based on conditions"})]}),e.jsx(p,{children:e.jsxs("form",{onSubmit:b,className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(o,{htmlFor:"rule-name",children:"Rule Name"}),e.jsx(j,{id:"rule-name",value:a.name,onChange:s=>r({...a,name:s.target.value}),placeholder:"e.g., Sort by Speaker",required:!0})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(o,{htmlFor:"condition-type",children:"Condition Type"}),e.jsxs(f,{value:a.condition_type,onValueChange:s=>r({...a,condition_type:s}),children:[e.jsx(g,{children:e.jsx(N,{})}),e.jsxs(_,{children:[e.jsx(n,{value:"speaker",children:"Speaker"}),e.jsx(n,{value:"series",children:"Series"}),e.jsx(n,{value:"date",children:"Date"}),e.jsx(n,{value:"filename",children:"Filename"})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(o,{htmlFor:"condition-value",children:"Condition Value"}),e.jsx(j,{id:"condition-value",value:a.condition_value,onChange:s=>r({...a,condition_value:s.target.value}),placeholder:"e.g., John Doe",required:!0})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(o,{htmlFor:"action-type",children:"Action Type"}),e.jsxs(f,{value:a.action_type,onValueChange:s=>r({...a,action_type:s}),children:[e.jsx(g,{children:e.jsx(N,{})}),e.jsxs(_,{children:[e.jsx(n,{value:"add_metadata",children:"Add Metadata"}),e.jsx(n,{value:"move_to_folder",children:"Move to Folder"})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(o,{htmlFor:"action-value",children:"Action Value"}),e.jsx(j,{id:"action-value",value:a.action_value,onChange:s=>r({...a,action_value:s.target.value}),placeholder:"e.g., /sermons/john-doe",required:!0})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(c,{type:"submit",children:"Create Rule"}),e.jsx(c,{type:"button",variant:"outline",onClick:()=>d(!1),children:"Cancel"})]})]})})]}),e.jsx("div",{className:"space-y-4",children:v.length===0?e.jsx(x,{children:e.jsx(p,{className:"p-8 text-center text-gray-500",children:"No sorting rules yet. Create one to automatically organize your files."})}):v.map(s=>e.jsx(x,{children:e.jsx(p,{className:"p-4",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"font-medium",children:s.name}),e.jsxs("p",{className:"text-sm text-gray-600 mt-1",children:["When ",e.jsx("span",{className:"font-medium",children:s.condition_type})," is"," ",e.jsx("span",{className:"font-medium",children:s.condition_value})]}),e.jsxs("p",{className:"text-sm text-gray-600",children:["Then ",e.jsx("span",{className:"font-medium",children:s.action_type}),":"," ",e.jsx("span",{className:"font-medium",children:s.action_value})]})]}),e.jsx(c,{variant:"ghost",size:"sm",onClick:()=>R(s.id),children:e.jsx(T,{className:"w-4 h-4"})})]})})},s.id))})]})}export{I as SmartSortingRules};
//# sourceMappingURL=SmartSortingRules-mLKAK052.js.map
