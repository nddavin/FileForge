import{r as x,R as L,j as e}from"./radix-vendor-DXnqCESz.js";import{j as O,u as k,C as $,e as G,k as K,l as R,B as P}from"./index-DHeBa6N9.js";import{u as T,a as I,D as A,c as V,b as W,s as q,K as z,P as _,d as M,S as H,v as J,C as Q}from"./dnd-vendor-Cmk3TZNM.js";import{l as U,U as X,j as B,E as Y,m as Z,n as ee,G as se,o as ae,p as te,q as re,k as ne}from"./icons-vendor-4PzZcNxV.js";import{f as ie}from"./date-vendor-Cb250gQT.js";import"./react-vendor-BS3SOam5.js";import"./utils-vendor-CbK4XRml.js";function ce({file:a,onStatusChange:b}){var N,m;const{attributes:h,listeners:l,setNodeRef:g,transform:o,transition:u,isDragging:d}=M({id:a.id}),S={transform:Q.Transform.toString(o),transition:u},D=(C=>C.startsWith("audio/")?B:C.startsWith("video/")?ne:U)(a.type);return e.jsx("div",{ref:g,style:S,className:K("bg-white rounded-lg shadow-sm border p-3 cursor-pointer transition-all",d?"opacity-50 shadow-lg":"hover:shadow-md"),children:e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx("button",{...h,...l,className:"text-gray-400 hover:text-gray-600 cursor-grab active:cursor-grabbing mt-1",children:e.jsx(se,{className:"w-4 h-4"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(D,{className:"w-5 h-5 text-blue-500 flex-shrink-0"}),e.jsx("h4",{className:"text-sm font-medium truncate",children:a.name})]}),e.jsxs("div",{className:"flex items-center gap-3 mt-2 text-xs text-gray-500",children:[((N=a.metadata)==null?void 0:N.speaker)&&e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(ae,{className:"w-3 h-3"}),e.jsx("span",{className:"truncate",children:a.metadata.speaker})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(te,{className:"w-3 h-3"}),e.jsx("span",{children:ie(new Date(a.created_at),{addSuffix:!0})})]})]}),((m=a.metadata)==null?void 0:m.series)&&e.jsx(R,{variant:"secondary",className:"mt-2 text-[10px]",children:a.metadata.series})]}),e.jsx(P,{variant:"ghost",size:"icon",className:"h-6 w-6",children:e.jsx(re,{className:"w-4 h-4"})})]})})}function oe({id:a,title:b,icon:h,files:l,color:g,onStatusChange:o}){const{setNodeRef:u}=M({id:a});return e.jsxs("div",{className:"flex flex-col bg-gray-50 rounded-xl h-full",children:[e.jsxs("div",{className:"flex items-center gap-2 p-3 border-b bg-white rounded-t-xl",children:[e.jsx("div",{className:K("p-1.5 rounded-lg",g),children:h}),e.jsx("h3",{className:"font-medium text-sm",children:b}),e.jsx(R,{variant:"secondary",className:"ml-auto",children:l.length})]}),e.jsxs("div",{ref:u,className:"flex-1 p-2 overflow-y-auto space-y-2 min-h-[200px]",children:[e.jsx(H,{items:l.map(d=>d.id),strategy:J,children:l.map(d=>e.jsx(ce,{file:d,onStatusChange:o},d.id))}),l.length===0&&e.jsxs("div",{className:"flex flex-col items-center justify-center py-8 text-center text-gray-400",children:[e.jsx(ee,{className:"w-8 h-8 mb-2 opacity-50"}),e.jsx("p",{className:"text-xs",children:"Drop files here"})]})]})]})}const y=[{id:"uploaded",title:"Uploaded",icon:e.jsx(X,{className:"w-4 h-4"}),color:"bg-gray-100 text-gray-600"},{id:"transcribed",title:"Transcribed",icon:e.jsx(B,{className:"w-4 h-4"}),color:"bg-blue-100 text-blue-600"},{id:"reviewed",title:"Reviewed",icon:e.jsx(Y,{className:"w-4 h-4"}),color:"bg-yellow-100 text-yellow-600"},{id:"published",title:"Published",icon:e.jsx(Z,{className:"w-4 h-4"}),color:"bg-green-100 text-green-600"}];function fe(){var E;const{files:a,loading:b,updateFileStatus:h}=O(),[l,g]=x.useState(null),[o,u]=x.useState([]);L.useEffect(()=>{a.length>0&&u(a)},[a]);const d=T(I(_,{activationConstraint:{distance:8}}),I(z,{coordinateGetter:q})),S=x.useMemo(()=>{const s={uploaded:[],transcribed:[],reviewed:[],published:[]};return o.forEach(t=>{var n;const r=((n=t.metadata)==null?void 0:n.status)||"uploaded";s[r]?s[r].push(t):s.uploaded.push(t)}),s},[o]),F=x.useCallback(s=>{g(s.active.id)},[]),D=x.useCallback(s=>{const{active:t,over:r}=s;if(!r)return;const n=m(t.id),i=m(r.id);!n||!i||n===i||u(c=>{const f=c.filter(v=>v.id===t.id);if(f.length===0)return c;f[0];const j=c.filter(v=>m(v.id)===i),p=j.findIndex(v=>v.id===r.id);return p>=0||j.length,c})},[]),N=x.useCallback(async s=>{var c;const{active:t,over:r}=s;if(g(null),!r)return;const n=m(t.id),i=m(r.id)||r.id;if(!(!n||!i)&&n!==i){const f=i;try{await h(t.id,f);const j=a.find(p=>p.id===t.id);j&&k.success(`Moved "${j.name}" to ${(c=y.find(p=>p.id===f))==null?void 0:c.title}`)}catch{k.error("Failed to update file status")}}},[a,h]),m=x.useCallback(s=>{var t,r;return y.some(n=>n.id===s)?s:((r=(t=o.find(n=>n.id===s))==null?void 0:t.metadata)==null?void 0:r.status)||"uploaded"},[o]),C=x.useCallback((s,t)=>{var n;u(i=>i.map(c=>c.id===s?{...c,metadata:{...c.metadata,status:t}}:c));const r=o.find(i=>i.id===s);r&&k.success(`Moved "${r.name}" to ${(n=y.find(i=>i.id===t))==null?void 0:n.title}`)},[o]),w=l?o.find(s=>s.id===l):null;return b?e.jsx($,{children:e.jsx(G,{className:"flex items-center justify-center h-96",children:e.jsx("div",{className:"text-lg text-gray-500",children:"Loading Kanban board..."})})}):e.jsxs(A,{sensors:d,collisionDetection:V,onDragStart:F,onDragOver:D,onDragEnd:N,children:[e.jsx("div",{className:"grid grid-cols-4 gap-4 h-[600px]",children:y.map(s=>e.jsx(oe,{id:s.id,title:s.title,icon:s.icon,color:s.color,files:S[s.id]||[],onStatusChange:C},s.id))}),e.jsx(W,{children:w?e.jsxs("div",{className:"bg-white rounded-lg shadow-lg border p-3 w-[280px]",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(U,{className:"w-5 h-5 text-blue-500"}),e.jsx("h4",{className:"text-sm font-medium truncate",children:w.name})]}),((E=w.metadata)==null?void 0:E.speaker)&&e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:w.metadata.speaker})]}):null})]})}export{fe as KanbanBoard};
//# sourceMappingURL=KanbanBoard-GD7x4Jbn.js.map
