{"version":3,"file":"SmartSortingRules-mLKAK052.js","sources":["../../src/app/components/SmartSortingRules.tsx"],"sourcesContent":["import React, { useState, useEffect } from 'react';\nimport { Button } from '@/app/components/ui/button';\nimport { Input } from '@/app/components/ui/input';\nimport { Label } from '@/app/components/ui/label';\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from '@/app/components/ui/card';\nimport { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from '@/app/components/ui/select';\nimport { Plus, Trash2 } from 'lucide-react';\nimport { projectId, publicAnonKey } from '/utils/supabase/info';\nimport { toast } from 'sonner';\n\ninterface Rule {\n  id: string;\n  name: string;\n  condition_type: 'speaker' | 'series' | 'date' | 'filename';\n  condition_value: string;\n  action_type: 'move_to_folder' | 'add_metadata';\n  action_value: string;\n  created_at: string;\n}\n\nexport function SmartSortingRules() {\n  const [rules, setRules] = useState<Rule[]>([]);\n  const [loading, setLoading] = useState(true);\n  const [showForm, setShowForm] = useState(false);\n  \n  const [newRule, setNewRule] = useState({\n    name: '',\n    condition_type: 'speaker' as const,\n    condition_value: '',\n    action_type: 'add_metadata' as const,\n    action_value: '',\n  });\n\n  useEffect(() => {\n    fetchRules();\n  }, []);\n\n  const fetchRules = async () => {\n    try {\n      const response = await fetch(\n        `https://${projectId}.supabase.co/functions/v1/make-server-24311ee2/rules`,\n        {\n          headers: {\n            Authorization: `Bearer ${publicAnonKey}`,\n          },\n        }\n      );\n\n      if (response.ok) {\n        const data = await response.json();\n        setRules(data);\n      }\n    } catch (error) {\n      console.error('Error fetching rules:', error);\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const handleCreateRule = async (e: React.FormEvent) => {\n    e.preventDefault();\n    \n    try {\n      const response = await fetch(\n        `https://${projectId}.supabase.co/functions/v1/make-server-24311ee2/rules`,\n        {\n          method: 'POST',\n          headers: {\n            'Content-Type': 'application/json',\n            Authorization: `Bearer ${publicAnonKey}`,\n          },\n          body: JSON.stringify(newRule),\n        }\n      );\n\n      if (response.ok) {\n        toast.success('Rule created successfully');\n        setNewRule({\n          name: '',\n          condition_type: 'speaker',\n          condition_value: '',\n          action_type: 'add_metadata',\n          action_value: '',\n        });\n        setShowForm(false);\n        await fetchRules();\n      } else {\n        toast.error('Failed to create rule');\n      }\n    } catch (error) {\n      console.error('Error creating rule:', error);\n      toast.error('Failed to create rule');\n    }\n  };\n\n  const handleDeleteRule = async (ruleId: string) => {\n    if (!confirm('Are you sure you want to delete this rule?')) {\n      return;\n    }\n\n    try {\n      const response = await fetch(\n        `https://${projectId}.supabase.co/functions/v1/make-server-24311ee2/rules/${ruleId}`,\n        {\n          method: 'DELETE',\n          headers: {\n            Authorization: `Bearer ${publicAnonKey}`,\n          },\n        }\n      );\n\n      if (response.ok) {\n        toast.success('Rule deleted successfully');\n        await fetchRules();\n      } else {\n        toast.error('Failed to delete rule');\n      }\n    } catch (error) {\n      console.error('Error deleting rule:', error);\n      toast.error('Failed to delete rule');\n    }\n  };\n\n  if (loading) {\n    return <div className=\"p-4\">Loading rules...</div>;\n  }\n\n  return (\n    <div className=\"p-4 space-y-4\">\n      <div className=\"flex justify-between items-center\">\n        <h2 className=\"text-2xl font-bold\">Smart Sorting Rules</h2>\n        <Button onClick={() => setShowForm(!showForm)}>\n          <Plus className=\"w-4 h-4 mr-2\" />\n          Add Rule\n        </Button>\n      </div>\n\n      {showForm && (\n        <Card>\n          <CardHeader>\n            <CardTitle>Create New Rule</CardTitle>\n            <CardDescription>\n              Automatically organize files based on conditions\n            </CardDescription>\n          </CardHeader>\n          <CardContent>\n            <form onSubmit={handleCreateRule} className=\"space-y-4\">\n              <div className=\"space-y-2\">\n                <Label htmlFor=\"rule-name\">Rule Name</Label>\n                <Input\n                  id=\"rule-name\"\n                  value={newRule.name}\n                  onChange={(e) => setNewRule({ ...newRule, name: e.target.value })}\n                  placeholder=\"e.g., Sort by Speaker\"\n                  required\n                />\n              </div>\n\n              <div className=\"grid grid-cols-2 gap-4\">\n                <div className=\"space-y-2\">\n                  <Label htmlFor=\"condition-type\">Condition Type</Label>\n                  <Select\n                    value={newRule.condition_type}\n                    onValueChange={(value: any) =>\n                      setNewRule({ ...newRule, condition_type: value })\n                    }\n                  >\n                    <SelectTrigger>\n                      <SelectValue />\n                    </SelectTrigger>\n                    <SelectContent>\n                      <SelectItem value=\"speaker\">Speaker</SelectItem>\n                      <SelectItem value=\"series\">Series</SelectItem>\n                      <SelectItem value=\"date\">Date</SelectItem>\n                      <SelectItem value=\"filename\">Filename</SelectItem>\n                    </SelectContent>\n                  </Select>\n                </div>\n\n                <div className=\"space-y-2\">\n                  <Label htmlFor=\"condition-value\">Condition Value</Label>\n                  <Input\n                    id=\"condition-value\"\n                    value={newRule.condition_value}\n                    onChange={(e) =>\n                      setNewRule({ ...newRule, condition_value: e.target.value })\n                    }\n                    placeholder=\"e.g., John Doe\"\n                    required\n                  />\n                </div>\n              </div>\n\n              <div className=\"grid grid-cols-2 gap-4\">\n                <div className=\"space-y-2\">\n                  <Label htmlFor=\"action-type\">Action Type</Label>\n                  <Select\n                    value={newRule.action_type}\n                    onValueChange={(value: any) =>\n                      setNewRule({ ...newRule, action_type: value })\n                    }\n                  >\n                    <SelectTrigger>\n                      <SelectValue />\n                    </SelectTrigger>\n                    <SelectContent>\n                      <SelectItem value=\"add_metadata\">Add Metadata</SelectItem>\n                      <SelectItem value=\"move_to_folder\">Move to Folder</SelectItem>\n                    </SelectContent>\n                  </Select>\n                </div>\n\n                <div className=\"space-y-2\">\n                  <Label htmlFor=\"action-value\">Action Value</Label>\n                  <Input\n                    id=\"action-value\"\n                    value={newRule.action_value}\n                    onChange={(e) =>\n                      setNewRule({ ...newRule, action_value: e.target.value })\n                    }\n                    placeholder=\"e.g., /sermons/john-doe\"\n                    required\n                  />\n                </div>\n              </div>\n\n              <div className=\"flex gap-2\">\n                <Button type=\"submit\">Create Rule</Button>\n                <Button type=\"button\" variant=\"outline\" onClick={() => setShowForm(false)}>\n                  Cancel\n                </Button>\n              </div>\n            </form>\n          </CardContent>\n        </Card>\n      )}\n\n      <div className=\"space-y-4\">\n        {rules.length === 0 ? (\n          <Card>\n            <CardContent className=\"p-8 text-center text-gray-500\">\n              No sorting rules yet. Create one to automatically organize your files.\n            </CardContent>\n          </Card>\n        ) : (\n          rules.map((rule) => (\n            <Card key={rule.id}>\n              <CardContent className=\"p-4\">\n                <div className=\"flex items-start justify-between\">\n                  <div className=\"flex-1\">\n                    <h3 className=\"font-medium\">{rule.name}</h3>\n                    <p className=\"text-sm text-gray-600 mt-1\">\n                      When <span className=\"font-medium\">{rule.condition_type}</span> is{' '}\n                      <span className=\"font-medium\">{rule.condition_value}</span>\n                    </p>\n                    <p className=\"text-sm text-gray-600\">\n                      Then <span className=\"font-medium\">{rule.action_type}</span>:{' '}\n                      <span className=\"font-medium\">{rule.action_value}</span>\n                    </p>\n                  </div>\n                  <Button\n                    variant=\"ghost\"\n                    size=\"sm\"\n                    onClick={() => handleDeleteRule(rule.id)}\n                  >\n                    <Trash2 className=\"w-4 h-4\" />\n                  </Button>\n                </div>\n              </CardContent>\n            </Card>\n          ))\n        )}\n      </div>\n    </div>\n  );\n}\n"],"names":["SmartSortingRules","rules","setRules","useState","loading","setLoading","showForm","setShowForm","newRule","setNewRule","useEffect","fetchRules","response","projectId","publicAnonKey","data","error","handleCreateRule","e","toast","handleDeleteRule","ruleId","jsx","jsxs","Button","Plus","Card","CardHeader","CardTitle","CardDescription","CardContent","Label","Input","Select","value","SelectTrigger","SelectValue","SelectContent","SelectItem","rule","Trash2"],"mappings":"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"}