import{r as n,j as e,R as se}from"./radix-vendor-DXnqCESz.js";import{k as m,n as B,u as M,B as T,C as G,b as ae,c as te,e as q,j as re,S as H,f as L,g as O,h as Q,i as w,o as le,l as x}from"./index-DHeBa6N9.js";import{C as V}from"./checkbox-BN-lIGCg.js";import{P as ce}from"./progress-05Dja7FS.js";import{U as W,L as X,d as ie,ad as ne,X as de,t as oe,o as me,z as E,$ as xe,l as $,j as J,k as K,ah as he,b as ue,C as ge}from"./icons-vendor-4PzZcNxV.js";import"./react-vendor-BS3SOam5.js";import"./utils-vendor-CbK4XRml.js";import"./date-vendor-Cb250gQT.js";const Y=n.forwardRef(({className:l,...d},c)=>e.jsx("div",{className:"relative w-full overflow-auto",children:e.jsx("table",{ref:c,className:m("w-full caption-bottom text-sm",l),...d})}));Y.displayName="Table";const Z=n.forwardRef(({className:l,...d},c)=>e.jsx("thead",{ref:c,className:m("[&_tr]:border-b",l),...d}));Z.displayName="TableHeader";const ee=n.forwardRef(({className:l,...d},c)=>e.jsx("tbody",{ref:c,className:m("[&_tr:last-child]:border-0",l),...d}));ee.displayName="TableBody";const pe=n.forwardRef(({className:l,...d},c)=>e.jsx("tfoot",{ref:c,className:m("border-t bg-gray-50 font-medium [&>tr]:last:border-b-0",l),...d}));pe.displayName="TableFooter";const D=n.forwardRef(({className:l,...d},c)=>e.jsx("tr",{ref:c,className:m("border-b transition-colors hover:bg-gray-50 data-[state=selected]:bg-gray-100",l),...d}));D.displayName="TableRow";const p=n.forwardRef(({className:l,...d},c)=>e.jsx("th",{ref:c,className:m("h-12 px-4 text-left align-middle font-medium text-gray-500 [&:has([role=checkbox])]:pr-0",l),...d}));p.displayName="TableHead";const u=n.forwardRef(({className:l,...d},c)=>e.jsx("td",{ref:c,className:m("p-4 align-middle [&:has([role=checkbox])]:pr-0",l),...d}));u.displayName="TableCell";const je=n.forwardRef(({className:l,...d},c)=>e.jsx("caption",{ref:c,className:m("mt-4 text-sm text-gray-500",l),...d}));je.displayName="TableCaption";const S={maxFileSize:500*1024*1024,allowedTypes:["audio/mpeg","audio/wav","audio/ogg","video/mp4","video/webm","video/quicktime"],maxFiles:20};function fe(){const[l,d]=n.useState(!1),[c,h]=n.useState([]),[F,v]=n.useState(!1),j=se.useRef(null),z=n.useCallback(a=>a.size>S.maxFileSize?`File size exceeds ${B(S.maxFileSize)}`:S.allowedTypes.includes(a.type)?null:`File type ${a.type} not allowed`,[]),f=n.useCallback(async a=>{if(!a||a.length===0)return;if(a.length>S.maxFiles){M.error(`Maximum ${S.maxFiles} files allowed at once`);return}const s=[];for(const t of Array.from(a)){const r=z(t);if(r){M.error(`${t.name}: ${r}`);continue}s.push({id:`${Date.now()}-${Math.random().toString(36).substr(2,9)}`,file:t,progress:0,status:"pending"})}h(t=>[...t,...s]),await R(s)},[z]),R=async a=>{v(!0);for(const s of a){h(t=>t.map(r=>r.id===s.id?{...r,status:"uploading"}:r));try{const r=Math.ceil(s.file.size/1048576);for(let i=0;i<r;i++)await new Promise(o=>setTimeout(o,100)),h(o=>o.map(g=>g.id===s.id?{...g,progress:Math.round((i+1)/r*100)}:g));h(i=>i.map(o=>o.id===s.id?{...o,status:"processing"}:o)),await new Promise(i=>setTimeout(i,1500)),h(i=>i.map(o=>o.id===s.id?{...o,status:"completed",progress:100}:o)),M.success(`Uploaded: ${s.file.name}`)}catch{h(r=>r.map(i=>i.id===s.id?{...i,status:"error",error:"Upload failed"}:i))}}v(!1)},b=n.useCallback(a=>{h(s=>s.filter(t=>t.id!==a))},[]),U=n.useCallback(()=>{h(a=>a.filter(s=>s.status!=="completed"))},[]),P=n.useCallback(a=>{a.preventDefault(),d(!0)},[]),y=n.useCallback(a=>{a.preventDefault(),d(!1)},[]),N=n.useCallback(a=>{a.preventDefault(),d(!1),f(a.dataTransfer.files)},[f]),A=a=>a.startsWith("audio/")?J:a.startsWith("video/")?K:$,I=a=>{switch(a){case"uploading":return e.jsx(x,{className:"bg-blue-100 text-blue-700",children:"Uploading"});case"processing":return e.jsx(x,{className:"bg-purple-100 text-purple-700",children:"Processing"});case"completed":return e.jsx(x,{className:"bg-green-100 text-green-700",children:"Completed"});case"error":return e.jsx(x,{className:"bg-red-100 text-red-700",children:"Failed"});default:return e.jsx(x,{variant:"secondary",children:"Pending"})}};return e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:m("border-2 border-dashed rounded-lg p-8 text-center transition-colors",l?"border-blue-500 bg-blue-50":"border-gray-200 hover:border-gray-300"),onDragOver:P,onDragLeave:y,onDrop:N,children:[e.jsx(W,{className:m("w-10 h-10 mx-auto mb-4",l?"text-blue-500":"text-gray-400")}),e.jsx("p",{className:"text-lg font-medium text-gray-900 mb-2",children:"Drag and drop files here"}),e.jsx("p",{className:"text-sm text-gray-500 mb-4",children:"or click to browse (audio/video up to 500MB)"}),e.jsx("input",{ref:j,type:"file",multiple:!0,accept:"audio/*,video/*",className:"hidden",onChange:a=>f(a.target.files)}),e.jsxs(T,{onClick:()=>{var a;return(a=j.current)==null?void 0:a.click()},disabled:F,children:[e.jsx(W,{className:"w-4 h-4 mr-2"}),"Select Files"]})]}),c.length>0&&e.jsxs(G,{children:[e.jsx(ae,{className:"pb-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(te,{className:"text-lg",children:"Upload Queue"}),c.some(a=>a.status==="completed")&&e.jsx(T,{variant:"outline",size:"sm",onClick:U,children:"Clear Completed"})]})}),e.jsx(q,{className:"space-y-3",children:c.map(a=>{const s=A(a.file.type);return e.jsxs("div",{className:"flex items-center gap-4 p-3 rounded-lg border bg-white",children:[e.jsx(s,{className:"w-8 h-8 text-blue-500 flex-shrink-0"}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center justify-between mb-1",children:[e.jsx("p",{className:"text-sm font-medium truncate",children:a.file.name}),I(a.status)]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-xs text-gray-500",children:B(a.file.size)}),a.status==="uploading"&&e.jsx(ce,{value:a.progress,className:"flex-1 h-1.5"}),a.status==="processing"&&e.jsx(X,{className:"w-4 h-4 text-purple-500 animate-spin"}),a.status==="completed"&&e.jsx(ie,{className:"w-4 h-4 text-green-500"}),a.status==="error"&&e.jsx(ne,{className:"w-4 h-4 text-red-500"})]}),a.error&&e.jsx("p",{className:"text-xs text-red-500 mt-1",children:a.error})]}),e.jsx(T,{variant:"ghost",size:"icon",className:"h-8 w-8",onClick:()=>b(a.id),disabled:a.status==="uploading"||a.status==="processing",children:e.jsx(de,{className:"w-4 h-4"})})]},a.id)})})]})]})}function Ne(){const{files:l,loading:d,selectedFiles:c,toggleSelection:h,selectAll:F,clearSelection:v}=re(),[j,z]=n.useState({field:"date",direction:"desc"}),[f,R]=n.useState("all"),[b,U]=n.useState("all"),P=n.useMemo(()=>{const s=new Set;return l.forEach(t=>{var r;(r=t.metadata)!=null&&r.speaker&&s.add(t.metadata.speaker)}),Array.from(s).sort()},[l]),y=n.useMemo(()=>{let s=[...l];return f!=="all"&&(s=s.filter(t=>{var r;return((r=t.metadata)==null?void 0:r.speaker)===f})),b!=="all"&&(s=s.filter(t=>{var r;return(((r=t.metadata)==null?void 0:r.status)||"ready")===b})),s.sort((t,r)=>{var o,g,C,k;let i=0;switch(j.field){case"name":i=t.name.localeCompare(r.name);break;case"date":i=new Date(t.created_at).getTime()-new Date(r.created_at).getTime();break;case"size":i=t.size-r.size;break;case"confidence":i=(((o=t.metadata)==null?void 0:o.confidence)||0)*100-(((g=r.metadata)==null?void 0:g.confidence)||0)*100;break;case"status":i=(((C=t.metadata)==null?void 0:C.status)||"").localeCompare(((k=r.metadata)==null?void 0:k.status)||"");break}return j.direction==="asc"?i:-i}),s},[l,j,f,b]),N=s=>{z(t=>({field:s,direction:t.field===s&&t.direction==="desc"?"asc":"desc"}))},A=s=>s.startsWith("audio/")?J:s.startsWith("video/")?K:$,I=s=>{switch(s){case"processing":return e.jsx(x,{className:"bg-blue-100 text-blue-700",children:"Processing"});case"ready":return e.jsx(x,{className:"bg-green-100 text-green-700",children:"Ready"});case"failed":return e.jsx(x,{className:"bg-red-100 text-red-700",children:"Failed"});default:return e.jsx(x,{variant:"secondary",children:s})}},a=({field:s})=>j.field!==s?e.jsx(he,{className:"w-4 h-4 text-gray-400"}):j.direction==="asc"?e.jsx(ue,{className:"w-4 h-4"}):e.jsx(ge,{className:"w-4 h-4"});return d?e.jsx("div",{className:"flex items-center justify-center h-96",children:e.jsx(X,{className:"w-8 h-8 animate-spin text-gray-400"})}):e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(oe,{className:"w-4 h-4 text-gray-500"}),e.jsx("span",{className:"text-sm font-medium",children:"Filters:"})]}),e.jsxs(H,{value:f,onValueChange:R,children:[e.jsx(L,{className:"w-[180px]",children:e.jsx(O,{placeholder:"All Preachers"})}),e.jsxs(Q,{children:[e.jsx(w,{value:"all",children:"All Preachers"}),P.map(s=>e.jsx(w,{value:s,children:s},s))]})]}),e.jsxs(H,{value:b,onValueChange:U,children:[e.jsx(L,{className:"w-[150px]",children:e.jsx(O,{placeholder:"All Status"})}),e.jsxs(Q,{children:[e.jsx(w,{value:"all",children:"All Status"}),e.jsx(w,{value:"processing",children:"Processing"}),e.jsx(w,{value:"ready",children:"Ready"}),e.jsx(w,{value:"failed",children:"Failed"})]})]}),e.jsx("div",{className:"ml-auto flex items-center gap-2",children:c.size>0&&e.jsxs(e.Fragment,{children:[e.jsxs("span",{className:"text-sm text-gray-500",children:[c.size," selected"]}),e.jsx(T,{variant:"outline",size:"sm",onClick:v,children:"Clear"}),e.jsx(T,{variant:"outline",size:"sm",onClick:F,children:"Select All"})]})})]}),e.jsx(G,{children:e.jsx(q,{className:"p-0",children:e.jsxs(Y,{children:[e.jsx(Z,{children:e.jsxs(D,{children:[e.jsx(p,{className:"w-[50px]",children:e.jsx(V,{checked:l.length>0&&c.size===l.length,onCheckedChange:s=>{s?F():v()}})}),e.jsx(p,{className:"cursor-pointer",onClick:()=>N("name"),children:e.jsxs("div",{className:"flex items-center gap-2",children:["Filename",e.jsx(a,{field:"name"})]})}),e.jsx(p,{className:"cursor-pointer",onClick:()=>N("status"),children:e.jsxs("div",{className:"flex items-center gap-2",children:["Status",e.jsx(a,{field:"status"})]})}),e.jsx(p,{className:"cursor-pointer",onClick:()=>N("date"),children:e.jsxs("div",{className:"flex items-center gap-2",children:["Date",e.jsx(a,{field:"date"})]})}),e.jsx(p,{children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(me,{className:"w-4 h-4"}),"Preacher"]})}),e.jsx(p,{className:"cursor-pointer",onClick:()=>N("confidence"),children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(E,{className:"w-4 h-4"}),"Quality",e.jsx(a,{field:"confidence"})]})}),e.jsx(p,{children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(xe,{className:"w-4 h-4"}),"Team"]})}),e.jsx(p,{className:"cursor-pointer",onClick:()=>N("size"),children:e.jsxs("div",{className:"flex items-center gap-2",children:["Size",e.jsx(a,{field:"size"})]})})]})}),e.jsx(ee,{children:y.length===0?e.jsx(D,{children:e.jsxs(u,{colSpan:8,className:"text-center py-12",children:[e.jsx($,{className:"w-12 h-12 mx-auto text-gray-300 mb-4"}),e.jsx("p",{className:"text-gray-500",children:"No files found"})]})}):y.map(s=>{var i,o,g,C,k,_;const t=A(s.type),r=c.has(s.id);return e.jsxs(D,{className:m(r&&"bg-blue-50"),children:[e.jsx(u,{children:e.jsx(V,{checked:r,onCheckedChange:()=>h(s.id)})}),e.jsx(u,{children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(t,{className:"w-5 h-5 text-blue-500"}),e.jsx("span",{className:"font-medium truncate max-w-[200px]",children:s.name})]})}),e.jsx(u,{children:I(((i=s.metadata)==null?void 0:i.status)||"ready")}),e.jsx(u,{className:"text-sm text-gray-500",children:le(new Date(s.created_at),{addSuffix:!0})}),e.jsx(u,{children:(o=s.metadata)!=null&&o.speaker?e.jsx(x,{variant:"outline",children:s.metadata.speaker}):e.jsx("span",{className:"text-gray-400",children:"â€”"})}),e.jsx(u,{children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(E,{className:m("w-4 h-4",(((g=s.metadata)==null?void 0:g.confidence)||.9)>=.9?"text-green-500":(((C=s.metadata)==null?void 0:C.confidence)||.9)>=.8?"text-yellow-500":"text-red-500")}),e.jsxs("span",{className:"text-sm",children:[Math.round((((k=s.metadata)==null?void 0:k.confidence)||.9)*100),"%"]})]})}),e.jsx(u,{children:(_=s.metadata)!=null&&_.assignedTo?e.jsx(x,{variant:"secondary",children:s.metadata.assignedTo}):e.jsx("span",{className:"text-gray-400",children:"Unassigned"})}),e.jsx(u,{className:"text-sm text-gray-500",children:B(s.size)})]},s.id)})})]})})}),e.jsxs("div",{className:"text-sm text-gray-500",children:["Showing ",y.length," of ",l.length," files"]})]})}const Fe={FileUpload:fe,SmartFileGrid:Ne};export{fe as FileUpload,Ne as SmartFileGrid,Fe as default};
//# sourceMappingURL=FileManagement-BjT2j2fF.js.map
